<html ng-app="app" ng-controller="calendarControl">
<head>
	<title>Astro calendar</title>
	<script src="lib/angular.js"></script>
<script>	
	 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52254492-1', 'michalpaszkiewicz.co.uk');
  ga('send', 'pageview');
  </script>
</head>
<body style="background:black; color: darkred;">
	<div id="main-container">
		<h1 style="text-align: center; font-family: monospace; text-transform: lowercase; font-size: 50px; text-shadow: 0.5px 0.5px white;" ng-click="LOLOL = !LOLOL;">Astrophotography calendar</h1>
		<div id="years" ng-show="false">
			<div ng-repeat="year in years">{{year.year}}</div>
		</div>
		<div id="months">
			
		</div>
		
		<div ng-show="LOLOL">
			<div class="week names">
			    <span class="day">Sun</span><span class="day">
			    Mon</span><span class="day">
			    Tue</span><span class="day">
			    Wed</span><span class="day">
			    Thu</span><span class="day">
			    Fri</span><span class="day">Sat</span>
			</div>	
			<div class="week" ng-repeat="week in weeks">
				<div ng-repeat="day in week.days" style="display: inline-block; vertical-align:top; height:186px">
					<div ng-style="{'background-image':'url(images/small-' + {{day.img}} + ')'}" class="one-day">{{day.date}}</div>
					<div style="text-align: center;">{{date.date}}</div>
					<div style="text-align: center;" ng-show="date.post!=undefined"><a style="color:darkred" target="_blank" href="{{date.post}}">Go to post</a></div>
				</div>
			</div>
		</div>
		
		<div ng-repeat="date in dates" style="display: inline-block; vertical-align:top; height:186px">
			<img height=150 width=150 ng-src="images/small-{{date.img}}" ng-click="setBigIMG(date)">
			<div style="text-align: center;">{{date.date}}</div>
			<div style="text-align: center;" ng-show="date.post!=undefined"><a style="color:darkred" target="_blank" href="{{date.post}}">Go to post</a></div>
		</div>
		
		<div style="position: fixed; top:0; left:0; width: 100%; height: 100%; overflow-y: auto; display:inline-block; background:black;" ng-click="showBigIMG = !showBigIMG" ng-show="showBigIMG">
			<div ng-style="{'background-image':'url(images/' + BigIMG + ')'}" style="width: 100%; padding-bottom: 100%; background-size: cover;"></div>
		</div>
		<div id="footer-push"></div>
	</div>
	<div id="footer">By <a href="index.html" style="color: darkred">Michal Paszkiewicz</a></div>
	
	<style>
		html, body{height: 100%; width: 100%; margin: 0; padding: 0;}
		#main-container{min-height: 100%;}
		#footer-push, #footer{height: 50px;}
		#footer{margin-top: -50px; text-align: center;}
		
		.week{}
		.day{min-width: 150px; display: inline-block; text-align: center; text-shadow: 0.5px 0.5px 1px white; font-weight: bold; font-size: 40px;}
		.one-day{text-align: center; line-height: 150px; height: 150px; width: 150px; font-weight: bold; font-size: 40px; text-shadow: 0.5px 0.5px 1px white;}
	</style>
	
	<script>
		var astroModule = angular.module('app', []).
		controller("calendarControl", function calendarControl($scope){
		
			function daysInMonth(month,year) {
			    return new Date(year, month, 0).getDate();
			}
			
			function firstDayNumber(month,year) {
			    return new Date(year, month, 0).getDay();
			}
			
			$scope.setWeeks = function(){
				$scope.weeks = [];
				
				var nowTime = new Date();
				var lastTime = new Date();
				lastTime.setMonth(new Date().getMonth() - 1)
				var nowYear = nowTime.getUTCFullYear();
				var nowMonth = nowTime.getMonth();
				var nowAmountOfDays = daysInMonth(nowMonth, nowYear);
				var lastAmountOfDays = daysInMonth(lastTime.getMonth(), lastTime.getUTCFullYear());
				
				var firstDay = (firstDayNumber(nowMonth, nowYear) + 1) % 7;
				
				var finished = false;
				var counter = 0;
				
				while(finished == false){
					if($scope.weeks.length == 0 || $scope.weeks[$scope.weeks.length].days.length == 7){
						$scope.weeks.push({days: []});
					}
					
					if(counter < firstDay){
						$scope.weeks[$scope.weeks.length].days.push({date: lastAmountOfDays + counter + 1 - firstDay});
					}
					else if(counter < firstDay + nowAmountOfDays){
						$scope.weeks[$scope.weeks.length].days.push({date: counter - firstDay});
					}
					
					if(counter > nowAmountOfDays + firstDay){
						finished = true; 
					}
					counter++;
				}
			}
		
			$scope.showBigIMG = false;
			$scope.BigIMG = "images/first-ever-moon.JPG";
			
			$scope.setBigIMG = function(date){
				$scope.BigIMG=date.img;
				$scope.showBigIMG = !$scope.showBigIMG; 
	
			}
			
			$scope.weeks = [{
				days: [{date: 28}, {date: 29}, {date: 30}, {date: 31}, {date: 1}, {date: 2}, {date: 3}]
			}];
			
			$scope.setWeeks();
			
			$scope.years = [{year:2014},{year:2015}];
			
			/*$scope.months = function(){
			
			}*/
			
			$scope.dates = [
			{img:"SavedMeteor.jpg", date:"December 15th 2014", posted:{day: 15, month: 12, year: 2014}, post:"astrophotography.html"},
			{img:"first-ever-moon.JPG", date:"December 30th 2014", posted:{day: 30, month: 12, year: 2014}, post:"the-moon-and-jupiter.html"},
			{img:"Moon-epiphany.png", date:"January 3rd 2015", posted:{day: 3, month: 1, year: 2015}}];
		
		
		
		});
	</script>
	
</body>
</html>
