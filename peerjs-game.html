<head>
    <title>Michal Paszkiewicz PeerJS Game</title>
    <meta name="description" content="A tutorial explaining how to use PeerJS to create a browser based multiplayer game">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="styles.css">

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-52254492-1', 'michalpaszkiewicz.co.uk');
        ga('send', 'pageview');

    </script>
</head>
<body>

    <div class="main-container">
        <div id="panel1" class="panel">
            <div class="panel-box">
                <h1>Michal Paszkiewicz</h1>
                <h2>Blog</h2>
            </div>
        </div>

        <div id="panel2" class="panel">
            <div class="panel-box">
                <h2>How to create a multiplayer game with Peer JS</h2>
                <p>
                    <a class="inline-link" alt="Peer JS official site" href="http://peerjs.com/">Peer JS</a> is a cool tool for connecting two browsers using Web RTC. What does this mean?
                    This means we can easily connect two browsers without needing to handle all the date in a server in between. Sure, we still need a server to handle the IDs and connections of the browsers, but so long as you don't expect your app to have more than 50 connections, you can use the cloud based API that PeerJS provides for free. Awesome!
                </p>
                <p>
                    If you expect more than 50 connections, you can of course pay some money to have access to the more advanced versions of the API, but they also detail how you can easily create your own server to do what their API does! On top of all this, its all open source and we can look at it all on <a class="inline-link" alt="Peer JS Github repo" href="https://github.com/peers">GitHub</a>.
                </p>
                <p>
                    A cool example to study before embarking on creating your game is this <a class="inline-link" alt="Peer JS Chat App" href="http://cdn.peerjs.com/demo/chat.html">chat app</a>. Not bad, eh?
                </p>

                <h3>
                    Connecting through Peer JS
                </h3>
                <p>
                    First of all, you will need to include Peer js!
                </p>

                <div class="img-container">
                    <img src="images/PeerjsLink.PNG" alt="Including peerjs in your project" />
                </div>

                <p>
                    Next you will need to connect to the <a href="http://peerjs.com/peerserver" alt="Peer JS API" class="inline-link" target="_blank">peer js API</a> (for free!!), <a href="https://github.com/peers/peerjs-server" alt="Peer JS Server" class="inline-link" target="_blank">or create your own server</a>. here we will show what it looks like when you connect to the api
                </p>
                <div class="img-container">
                    <img src="images/PeerjsAPI.PNG" alt="Connecting to peerjs API" />
                </div>

                <p>
                    Great, now we can get started coding!
                </p>
                <p>
                    Generate an ID for yourself, preferably a <a href="http://stackoverflow.com/questions/1349404/generate-a-string-of-5-random-characters-in-javascript" alt="Random number generator" class="inline-link" target="_blank">random number</a> and create a peer.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsPeer.PNG" alt="Create a peer js peer!" />
                </div>

                <p>
                    Create an object to hold your connected peers.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsPeers.PNG" alt="Create object for connecting peers" />
                </div>

                <p>
                    Select what happens on the opening event of your peer connection.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsOpen.PNG" alt="Make stuff happen on the peer 'open' event" />
                </div>

                <p>
                    Tell your program what should happen when a peer connects.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsOnConnect.PNG" alt="Make stuff happen on peer 'connection' event" />
                </div>

                <p>
                    Define your connection function. Here I have defined what should happen when a peer connects, when he sends you some data, and when he closes the connection.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsConnect.PNG" alt="Define your connection function" />
                </div>

                <p>
                    Create an input textbox where you will put in your friend's id. Now, inside your $(document).ready() event, create actions, such as connecting to your friend using a button.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsDocReady.PNG" alt="Connect to a friend on document ready event" />
                </div>

                <p>
                    Now add other functions to your $(document).ready() event. These can be anything, from sending messages so you can chat, or sending information on what your friend has clicked or pressed - this is where you can send updates on what is happening at the other player's side if you are creating a game. Here we show a quick example of how to send a quick message.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsSendMessage.PNG" alt="Send your friend a message via peer js" />
                </div>

                <p>
                    And eachActiveConnection() is defined as follows, from divs containing IDs of connected peers:
                </p>

                <div class="img-container">
                    <img src="images/PeerjsEach.PNG" alt="Define the each active connection function" />
                </div>

                <p>
                    Now you just need one more function to ensure you close your connection properly when you close your tab/window. This will ensure your friend knows you have left.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsClose.PNG" alt="On close, destroy your peer!" />
                </div>

                <h3>A game of go built with PeerJS</h3><a class="link" alt="Play Go Online" href="http://www.michalpaszkiewicz.co.uk/go/">Link</a>

                <p>
                    So now, some details on how to create a basic game. I won't go too far into it, as you could keep working on this forever. If you would like to see my source code for my own project, it is <a href="https://github.com/MichalPaszkiewicz/go" alt="Go Source Code" class="inline-link">here</a>.
                </p>

                <p>
                    So, now that we have a working chat app, we now need to create a game. For a basic board game like noughts-and-crosses (tic-tac-toe) or go, we can start by creating a table in your html file.
                    I have done this by just creating a table element, then I populate it with rows and cells via script, so I can later easily change the size of the table.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsTable.PNG" alt="A function for creating a table/ changing table size" />
                </div>

                <p>
                    Once you have created your table, you will want to style it with css. In this example, I have added different images to the sides and corners, so when the table size is changed, the css will still create a beautiful board.
                </p>

                <div class="img-container" style="max-height:300px; background: #1E1E1E">
                    <img src="images/PeerjsTableStyle.PNG" alt="Peer JS game board CSS"/>
                </div>

                <p>
                    Now all that you need to do is make things happen when you do something to the board. 
                </p>

                <p>
                    Inside the document ready event, I have created an onClick event, that will send data when you click a td, and add a class to that particular td, that in this case will show up a white circle on the board.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsClick.PNG" alt="td click javascript code"/>
                </div>

                <p>
                    You can see here I am sending the td's id preceded by 'goMove='. To make something happen on the other player's table we now just need to add a function inside their connect function in the 'on data' event.
                </p>

                <div class="img-container">
                    <img src="images/PeerjsOnData.PNG" alt="On data JS function"/>
                </div>

                <p>
                    This will read the id and add the relevant class to the correct cell. Now you can add similar functions for other moves to allow all the options in the game, so you can play it!
                </p>

                <p>
                    The last things you might want to consider are whether you want to implement some rules in the program, to ensure noone does illegal moves and possibly some sort of security system whereby you ensure noone cheats by changing the code.

                </p>

                <p>
                    Good luck!
                </p>

            </div>
        </div>

        <div class="push"></div>
    </div>
    <div class="footer">
        <div class="panel-box">
            <a href="/index.html" alt="The main site of Michal Paszkiewicz">Main site</a>
            <a href="/blog.html" alt="The blog of Michal Paszkiewicz">Back to main blog page</a>
        </div>
    </div>
</body>
